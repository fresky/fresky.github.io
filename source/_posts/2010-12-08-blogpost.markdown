---
layout: post
title: "ASP .NET调用javascript中Response.Write和ClientScript.RegisterStartupScript的区别（2）"
date: 2010-12-08
comments: true
categories: 
---
另外，Response.Write不能调用aspx里面定义的javascript函数，ClientScript.RegisterStartupScrip可以，示例如下。<br />.cs代码<br /><div style="font-family: Courier New; font-size: 10pt; color: black; background: none repeat scroll 0% 0% rgb(204, 232, 207);"> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;1</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">StringBuilder</span> sb = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">StringBuilder</span>();</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;2</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sb.Append(<span style="color: rgb(163, 21, 21);">"&lt;script language=javascript&gt;"</span>);</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;3</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sb.Append(<span style="color: rgb(163, 21, 21);">"TestAlert();"</span>);</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;4</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sb.Append(<span style="color: rgb(163, 21, 21);">"&lt;/script&gt;"</span>);</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;5</span>&nbsp;</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;6</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green;">//Response.Write(sb.ToString());</span></p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;7</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ClientScript.RegisterStartupScript(<span style="color: blue;">this</span>.GetType(), <span style="color: rgb(163, 21, 21);">"test"</span>, sb.ToString());</p> </div>  .aspx代码<br /><div style="font-family: Courier New; font-size: 10pt; color: black; background: none repeat scroll 0% 0% rgb(204, 232, 207);"> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;1</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;script type=<span style="color: rgb(163, 21, 21);">"text/javascript"</span>&gt;</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;2</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; function TestAlert() {</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;3</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; alert(<span style="color: rgb(163, 21, 21);">'just a test'</span>);</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;4</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;5</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/script&gt;</p> </div>  可以看到Response.Write会出错，firebug里面提示TestAlert没有定义，而ClientScript.RegisterStartupScript可以正确执行。<br /><br /><div class="zemanta-pixie"><img class="zemanta-pixie-img" alt="" src="http://img.zemanta.com/pixy.gif?x-id=13e02c5b-39a4-850d-bd66-c809ec9bf1f5" /></div>