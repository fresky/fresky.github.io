---
layout: post
title: "ASP .NET调用javascript中Response.Write和ClientScript.RegisterStartupScript的区别"
date: 2010-12-08
comments: true
categories: 
---
最近在用ASP .NET的code behind 调用javascript中发现Response.Write不能拿到form的值，而ClientScript.RegisterStartupScript可以。例如下面的代码<br /><div style="font-family: Courier New; font-size: 10pt; color: black; background: none repeat scroll 0% 0% rgb(204, 232, 207);"> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;1</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">StringBuilder</span> sb = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">StringBuilder</span>();</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;2</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sb.Append(<span style="color: rgb(163, 21, 21);">"&lt;script language=javascript&gt;"</span>);</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;3</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sb.Append(<span style="color: rgb(163, 21, 21);">"alert(document.forms.length);"</span>);</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;4</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sb.Append(<span style="color: rgb(163, 21, 21);">"&lt;/script&gt;"</span>);</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;5</span>&nbsp;</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;6</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Response.Write(sb.ToString());</p> <p style="margin: 0px;"><span style="color: rgb(43, 145, 175);">&nbsp;&nbsp;&nbsp;&nbsp;7</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ClientScript.RegisterStartupScript(<span style="color: blue;">this</span>.GetType(), <span style="color: rgb(163, 21, 21);">"test"</span>, sb.ToString());</p> </div>  可以明显的看到，Response.Write得到的是0，ClientScript.RegisterStartupScript得到的是1。<br /><br /><div class="zemanta-pixie"><img class="zemanta-pixie-img" alt="" src="http://img.zemanta.com/pixy.gif?x-id=b246d450-c052-8f30-9f20-51a59d3b2bd1" /></div>