---
layout: post
title: "c#中判断一个process是32bit还是64bit"
date: 2012-10-09
comments: true
categories: 
---
<p>下面的代码能判断一个process是32bit还是64bit.</p>  <div style="border-bottom: #cccccc 1px solid; border-left: #cccccc 1px solid; padding-bottom: 5px; background-color: #f5f5f5; padding-left: 5px; padding-right: 5px; border-top: #cccccc 1px solid; border-right: #cccccc 1px solid; padding-top: 5px" class="cnblogs_code">   <pre><span style="color: #0000ff">static</span> <span style="color: #0000ff">class</span><span style="color: #000000"> ProcessDetector
    {
        </span><span style="color: #0000ff">public</span> <span style="color: #0000ff">static</span> <span style="color: #0000ff">bool</span><span style="color: #000000"> IsWin64(Process process)
        {
            </span><span style="color: #0000ff">if</span><span style="color: #000000"> (Environment.Is64BitOperatingSystem)
            {
                IntPtr processHandle;
                </span><span style="color: #0000ff">bool</span><span style="color: #000000"> retVal;

                </span><span style="color: #0000ff">try</span><span style="color: #000000">
                {
                    processHandle </span>=<span style="color: #000000"> Process.GetProcessById(process.Id).Handle;
                }
                </span><span style="color: #0000ff">catch</span><span style="color: #000000">
                {
                    </span><span style="color: #0000ff">return</span> <span style="color: #0000ff">false</span><span style="color: #000000">; 
                }
                </span><span style="color: #0000ff">return</span> Win32API.IsWow64Process(processHandle, <span style="color: #0000ff">out</span> retVal) &amp;&amp;<span style="color: #000000"> retVal;
            }

            </span><span style="color: #0000ff">return</span> <span style="color: #0000ff">false</span><span style="color: #000000">;
        }
    }

    </span><span style="color: #0000ff">internal</span> <span style="color: #0000ff">static</span> <span style="color: #0000ff">class</span><span style="color: #000000"> Win32API
    {
        [DllImport(</span><span style="color: #800000">&quot;</span><span style="color: #800000">kernel32.dll</span><span style="color: #800000">&quot;</span>, SetLastError = <span style="color: #0000ff">true</span>, CallingConvention =<span style="color: #000000"> CallingConvention.Winapi)]
        [</span><span style="color: #0000ff">return</span><span style="color: #000000">: MarshalAs(UnmanagedType.Bool)]
        </span><span style="color: #0000ff">internal</span> <span style="color: #0000ff">static</span> <span style="color: #0000ff">extern</span> <span style="color: #0000ff">bool</span> IsWow64Process([In] IntPtr process, [Out] <span style="color: #0000ff">out</span> <span style="color: #0000ff">bool</span><span style="color: #000000"> wow64Process);
    }</span></pre>
</div>