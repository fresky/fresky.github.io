---
layout: post
title: "C#的yield return是怎么被调用到的？"
date: 2013-02-27
comments: true
categories: 
---
<p>假设有如下代码：</p>  <div style="border-bottom: #cccccc 1px solid; border-left: #cccccc 1px solid; padding-bottom: 5px; background-color: #f5f5f5; padding-left: 5px; padding-right: 5px; border-top: #cccccc 1px solid; border-right: #cccccc 1px solid; padding-top: 5px" class="cnblogs_code">   <pre><span style="color: #0000ff">static</span> IEnumerable&lt;<span style="color: #0000ff">int</span>&gt;<span style="color: #000000"> getInt()
        {
            </span><span style="color: #0000ff">for</span> (<span style="color: #0000ff">int</span> i = <span style="color: #800080">0</span>; i &lt; <span style="color: #800080">3</span>; i++<span style="color: #000000">)
            {
                Console.WriteLine(</span><span style="color: #800000">&quot;</span><span style="color: #800000">get </span><span style="color: #800000">&quot;</span> +<span style="color: #000000"> i);
                </span><span style="color: #0000ff">yield</span> <span style="color: #0000ff">return</span><span style="color: #000000"> i;
            }

        }
        
        </span><span style="color: #0000ff">static</span> <span style="color: #0000ff">void</span> Main(<span style="color: #0000ff">string</span><span style="color: #000000">[] args)
        {
            </span><span style="color: #0000ff">for</span> (<span style="color: #0000ff">int</span> i = <span style="color: #800080">0</span>; i &lt; getInt().Count(); i++<span style="color: #000000">)
            {
                Console.WriteLine(getInt().ElementAt(i));
            }
        }</span></pre>
</div>

<p>输出结果是：</p>

<div style="border-bottom: #cccccc 1px solid; border-left: #cccccc 1px solid; padding-bottom: 5px; background-color: #f5f5f5; padding-left: 5px; padding-right: 5px; border-top: #cccccc 1px solid; border-right: #cccccc 1px solid; padding-top: 5px" class="cnblogs_code">
  <pre>get <span style="color: #800080">0</span><span style="color: #000000">
get </span><span style="color: #800080">1</span><span style="color: #000000">
get </span><span style="color: #800080">2</span><span style="color: #000000">
get </span><span style="color: #800080">0</span>
<span style="color: #800080">0</span><span style="color: #000000">
get </span><span style="color: #800080">0</span><span style="color: #000000">
get </span><span style="color: #800080">1</span><span style="color: #000000">
get </span><span style="color: #800080">2</span><span style="color: #000000">
get </span><span style="color: #800080">0</span><span style="color: #000000">
get </span><span style="color: #800080">1</span>
<span style="color: #800080">1</span><span style="color: #000000">
get </span><span style="color: #800080">0</span><span style="color: #000000">
get </span><span style="color: #800080">1</span><span style="color: #000000">
get </span><span style="color: #800080">2</span><span style="color: #000000">
get </span><span style="color: #800080">0</span><span style="color: #000000">
get </span><span style="color: #800080">1</span><span style="color: #000000">
get </span><span style="color: #800080">2</span>
<span style="color: #800080">2</span><span style="color: #000000">
get </span><span style="color: #800080">0</span><span style="color: #000000">
get </span><span style="color: #800080">1</span><span style="color: #000000">
get </span><span style="color: #800080">2</span></pre>
</div>

<p>呵呵，说明了.Count()和ElementAt都是需要迭代的。</p>