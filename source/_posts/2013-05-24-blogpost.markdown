---
layout: post
title: "C++的C4305和C4800的编译警告"
date: 2013-05-24
comments: true
categories: 
---
<p>今天在改代码时发现了这两个warning，<a href="http://msdn.microsoft.com/en-us/library/0as1ke3f%28v=vs.80%29.aspx">C4305</a> - 'identifier' : truncation from 'type1' to 'type2' 和<a href="http://msdn.microsoft.com/en-us/library/b6801kcy%28v=VS.71%29.aspx">C4800</a> - 'type' : forcing value to bool 'true' or 'false' (performance warning)。</p>  <p>大家看看下面的代码吧，一目了然。：）</p>  <div style="border-bottom: #cccccc 1px solid; border-left: #cccccc 1px solid; padding-bottom: 5px; background-color: #f5f5f5; padding-left: 5px; padding-right: 5px; border-top: #cccccc 1px solid; border-right: #cccccc 1px solid; padding-top: 5px" class="cnblogs_code">   <pre><span style="color: #0000ff">    int</span> a1 = <span style="color: #800080">1</span><span style="color: #000000">;
    </span><span style="color: #0000ff">int</span> a2 = <span style="color: #800080">2</span><span style="color: #000000">;
    MyEnum m </span>=<span style="color: #000000"> MyEnum::a;

    </span><span style="color: #0000ff">bool</span> b = <span style="color: #800080">1</span>;             <span style="color: #008000">//</span><span style="color: #008000"> no warning</span>
    b = <span style="color: #800080">2</span>;                  <span style="color: #008000">//</span><span style="color: #008000"> warning C4305: '=' : truncation from 'int' to 'bool'</span>
    b = a1;                 <span style="color: #008000">//</span><span style="color: #008000"> warning C4800: 'int' : forcing value to bool 'true' or 'false' (performance warning)    </span>
    b = a2;                 <span style="color: #008000">//</span><span style="color: #008000"> warning C4800: 'int' : forcing value to bool 'true' or 'false' (performance warning)    </span>
    b = MyEnum::a;          <span style="color: #008000">//</span><span style="color: #008000"> no warning</span>
    b = m;                  <span style="color: #008000">//</span><span style="color: #008000"> warning C4800: 'MyEnum' : forcing value to bool 'true' or 'false' (performance warning)    </span>
    b = !!a2;               <span style="color: #008000">//</span><span style="color: #008000"> no warning</span>
    b = a2!=<span style="color: #800080">0</span>;              <span style="color: #008000">//</span><span style="color: #008000"> no warning</span></pre>
</div>

<div class="cnblogs_Highlighter">
  <div class="cnblogs_Highlighter">
    <pre class="brush:cpp;collapse:false;;gutter:true;"><div class="cnblogs_Highlighter"><div class="cnblogs_Highlighter"><pre class="brush:py;collapse:false;;gutter:false;">&#160;</pre></div></div></pre>
  </div>
</div>